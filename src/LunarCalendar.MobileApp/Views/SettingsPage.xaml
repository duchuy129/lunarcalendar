<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:LunarCalendar.MobileApp.ViewModels"
             x:Class="LunarCalendar.MobileApp.Views.SettingsPage"
             Title="{Binding Title}"
             BackgroundColor="#FFF9F0">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Display Settings Section -->
            <Border Padding="0"
                    BackgroundColor="White"
                    Stroke="{DynamicResource Gray200}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="Display Settings"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Show Cultural Background -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Cultural Background"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="Display traditional Vietnamese cultural imagery"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding ShowCulturalBackground}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Show Lunar Dates -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Show Lunar Dates"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="Display lunar calendar dates on calendar grid"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding ShowLunarDates}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Upcoming Holidays Range -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto"
                          ColumnSpacing="12">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Upcoming Holidays Range"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="Number of days to show upcoming holidays"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding AvailableHolidaysDays}"
                                SelectedItem="{Binding UpcomingHolidaysDays}"
                                FontSize="14"
                                TextColor="{DynamicResource Primary}"
                                VerticalOptions="Center"
                                WidthRequest="80"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Interaction Settings Section -->
            <Border Padding="0"
                    BackgroundColor="White"
                    Stroke="{DynamicResource Gray200}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="Interaction Settings"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Enable Haptic Feedback -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Haptic Feedback"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="Vibrate on button presses (iOS only)"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding EnableHapticFeedback}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Sync Settings Section -->
            <Border Padding="0"
                    BackgroundColor="White"
                    Stroke="{DynamicResource Gray200}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="Sync &amp; Offline"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Online Status -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Connection Status"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding IsOnline, StringFormat='{0}'}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Label Grid.Column="1"
                               Text="{Binding IsOnline, StringFormat='{0}'}"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="{DynamicResource Primary}"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label"
                                           Binding="{Binding IsOnline}"
                                           Value="True">
                                    <Setter Property="Text" Value="Online" />
                                    <Setter Property="TextColor" Value="Green" />
                                </DataTrigger>
                                <DataTrigger TargetType="Label"
                                           Binding="{Binding IsOnline}"
                                           Value="False">
                                    <Setter Property="Text" Value="Offline" />
                                    <Setter Property="TextColor" Value="Orange" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Last Sync Time -->
                    <Grid Padding="16,12">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="Last Sync"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding LastSyncTime}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Sync Now Button -->
                    <Grid Padding="16,12">
                        <Button Text="Sync Now"
                                Command="{Binding SyncDataCommand}"
                                BackgroundColor="{DynamicResource Primary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill">
                            <Button.Triggers>
                                <DataTrigger TargetType="Button"
                                           Binding="{Binding IsSyncing}"
                                           Value="True">
                                    <Setter Property="Text" Value="Syncing..." />
                                    <Setter Property="IsEnabled" Value="False" />
                                </DataTrigger>
                            </Button.Triggers>
                        </Button>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Data Settings Section -->
            <Border Padding="0"
                    BackgroundColor="White"
                    Stroke="{DynamicResource Gray200}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="Data &amp; Storage"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Clear Cache Button -->
                    <Grid Padding="16,12">
                        <Button Text="Clear Cache &amp; Offline Data"
                                Command="{Binding ClearCacheCommand}"
                                BackgroundColor="{DynamicResource Primary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Reset Settings Button -->
                    <Grid Padding="16,12">
                        <Button Text="Reset All Settings"
                                Command="{Binding ResetSettingsCommand}"
                                BackgroundColor="{DynamicResource Tertiary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- About Section -->
            <Border Padding="0"
                    BackgroundColor="White"
                    Stroke="{DynamicResource Gray200}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="About"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- App Version -->
                    <Grid Padding="16,12">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="App Version"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding AppVersion}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- About Button -->
                    <Grid Padding="16,12">
                        <Button Text="About This App"
                                Command="{Binding AboutCommand}"
                                BackgroundColor="{DynamicResource Secondary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
