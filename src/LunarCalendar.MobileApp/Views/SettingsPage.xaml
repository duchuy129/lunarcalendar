<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:LunarCalendar.MobileApp.ViewModels"
             xmlns:ext="clr-namespace:LunarCalendar.MobileApp.Extensions"
             x:Class="LunarCalendar.MobileApp.Views.SettingsPage"
             Title="{Binding Title}"
             Background="{DynamicResource BackgroundGradient}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Language Settings Section -->
            <Border Padding="0"
                    Background="{DynamicResource SubtleCardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.06"
                            Radius="10"
                            Offset="0,3"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate Language}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Language Picker -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate Language}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{ext:Translate LanguageDesc}"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding AvailableLanguages}"
                                SelectedItem="{Binding SelectedLanguage}"
                                ItemDisplayBinding="{Binding NativeName}"
                                FontSize="14"
                                TextColor="{DynamicResource Primary}"
                                VerticalOptions="Center"
                                WidthRequest="150"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Display Settings Section -->
            <Border Padding="0"
                    Background="{DynamicResource SubtleCardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.06"
                            Radius="10"
                            Offset="0,3"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate DisplaySettings}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Show Cultural Background -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate CulturalBackground}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{ext:Translate CulturalBackgroundDesc}"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding ShowCulturalBackground}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Show Lunar Dates -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate ShowLunarDates}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{ext:Translate ShowLunarDatesDesc}"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding ShowLunarDates}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Upcoming Holidays Range -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto"
                          ColumnSpacing="12">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate UpcomingHolidaysRange}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{ext:Translate UpcomingHolidaysRangeDesc}"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding AvailableHolidaysDays}"
                                SelectedItem="{Binding UpcomingHolidaysDays}"
                                FontSize="14"
                                TextColor="{DynamicResource Primary}"
                                VerticalOptions="Center"
                                WidthRequest="80"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Interaction Settings Section -->
            <Border Padding="0"
                    Background="{DynamicResource SubtleCardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.06"
                            Radius="10"
                            Offset="0,4"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate InteractionSettings}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Enable Haptic Feedback -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate HapticFeedback}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{ext:Translate HapticFeedbackDesc}"
                                   FontSize="12"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Switch Grid.Column="1"
                                IsToggled="{Binding EnableHapticFeedback}"
                                OnColor="{DynamicResource Primary}"
                                VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Sync Settings Section -->
            <Border Padding="0"
                    Background="{DynamicResource CardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.1"
                            Radius="12"
                            Offset="0,4"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate SyncAndOffline}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Online Status -->
                    <Grid Padding="16,12"
                          ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="{ext:Translate ConnectionStatus}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding IsOnline, StringFormat='{0}'}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                        <Label Grid.Column="1"
                               Text="{Binding IsOnline, StringFormat='{0}'}"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="{DynamicResource Primary}"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label"
                                           Binding="{Binding IsOnline}"
                                           Value="True">
                                    <Setter Property="Text" Value="{ext:Translate Online}" />
                                    <Setter Property="TextColor" Value="Green" />
                                </DataTrigger>
                                <DataTrigger TargetType="Label"
                                           Binding="{Binding IsOnline}"
                                           Value="False">
                                    <Setter Property="Text" Value="{ext:Translate Offline}" />
                                    <Setter Property="TextColor" Value="Orange" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Last Sync Time -->
                    <Grid Padding="16,12">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="{ext:Translate LastSync}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding LastSyncTime}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Sync Now Button -->
                    <Grid Padding="16,12">
                        <Button Text="{ext:Translate SyncNow}"
                                Command="{Binding SyncDataCommand}"
                                BackgroundColor="{DynamicResource Primary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill">
                            <Button.Triggers>
                                <DataTrigger TargetType="Button"
                                           Binding="{Binding IsSyncing}"
                                           Value="True">
                                    <Setter Property="Text" Value="{ext:Translate Syncing}" />
                                    <Setter Property="IsEnabled" Value="False" />
                                </DataTrigger>
                            </Button.Triggers>
                        </Button>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Data Settings Section -->
            <Border Padding="0"
                    Background="{DynamicResource CardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.1"
                            Radius="12"
                            Offset="0,4"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate DataAndStorage}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- Clear Cache Button -->
                    <Grid Padding="16,12">
                        <Button Text="{ext:Translate ClearCache}"
                                Command="{Binding ClearCacheCommand}"
                                BackgroundColor="{DynamicResource Primary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- Reset Settings Button -->
                    <Grid Padding="16,12">
                        <Button Text="{ext:Translate ResetSettings}"
                                Command="{Binding ResetSettingsCommand}"
                                BackgroundColor="{DynamicResource Tertiary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- About Section -->
            <Border Padding="0"
                    Background="{DynamicResource CardGradient}"
                    StrokeThickness="0">
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Opacity="0.1"
                            Radius="12"
                            Offset="0,4"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="0">
                    <!-- Section Header -->
                    <Label Text="{ext:Translate About}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource Primary}"
                           Padding="16,16,16,8"/>

                    <!-- App Version -->
                    <Grid Padding="16,12">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="{ext:Translate AppVersion}"
                                   FontSize="16"
                                   TextColor="{DynamicResource Gray900}"/>
                            <Label Text="{Binding AppVersion}"
                                   FontSize="14"
                                   TextColor="{DynamicResource Gray600}"/>
                        </VerticalStackLayout>
                    </Grid>

                    <BoxView HeightRequest="1"
                             BackgroundColor="{DynamicResource Gray200}"
                             Margin="16,0"/>

                    <!-- About Button -->
                    <Grid Padding="16,12">
                        <Button Text="{ext:Translate AboutThisApp}"
                                Command="{Binding AboutCommand}"
                                BackgroundColor="{DynamicResource Secondary}"
                                TextColor="White"
                                CornerRadius="8"
                                HorizontalOptions="Fill"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
